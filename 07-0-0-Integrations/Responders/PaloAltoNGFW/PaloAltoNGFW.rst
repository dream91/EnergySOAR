PaloAltoNGFW
============

PaloAltoNGFW_block_external_IP_address
--------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      2.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Block external IP address

.. rubric:: Configuration

===========================================  ===============================================
Name                                         Description
Hostname_PaloAltoNGFW                        Hostname PaloAltoNGFW
User_PaloAltoNGFW                            User PaloAltoNGFW
Password_PaloAltoNGFW                        User PaloAltoNGFW
Security_rule_for_block_external_IP_address  Name external name security rule for IP address
TheHive_instance                             URL of the TheHive instance to query
TheHive_API_key                              TheHive API key with read access
===========================================  ===============================================


PaloAltoNGFW_block_external_domain
----------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      2.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Block external domain

.. rubric:: Configuration

=======================================  =======================================
Name                                     Description
Hostname_PaloAltoNGFW                    Hostname PaloAltoNGFW
User_PaloAltoNGFW                        User PaloAltoNGFW
Password_PaloAltoNGFW                    User PaloAltoNGFW
Security_rule_for_block_external_domain  Name external security rule for domains
TheHive_instance                         URL of the TheHive instance to query
TheHive_API_key                          TheHive API key with read access
=======================================  =======================================


PaloAltoNGFW_block_external_user
--------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Block external user

.. rubric:: Configuration

=====================================  =====================================
Name                                   Description
Hostname_PaloAltoNGFW                  Hostname PaloAltoNGFW
User_PaloAltoNGFW                      User PaloAltoNGFW
Password_PaloAltoNGFW                  User PaloAltoNGFW
Security_rule_for_block_external_user  Name security rule for external users
TheHive_instance                       URL of the TheHive instance to query
TheHive_API_key                        TheHive API key with read access
=====================================  =====================================


PaloAltoNGFW_block_internal_IP_address
--------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      2.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Block internal IP address

.. rubric:: Configuration

===========================================  ==========================================
Name                                         Description
Hostname_PaloAltoNGFW                        Hostname PaloAltoNGFW
User_PaloAltoNGFW                            User PaloAltoNGFW
Password_PaloAltoNGFW                        User PaloAltoNGFW
Security_rule_for_block_internal_IP_address  Name internal security rule for IP address
TheHive_instance                             URL of the TheHive instance to query
TheHive_API_key                              TheHive API key with read access
===========================================  ==========================================


PaloAltoNGFW_block_internal_domain
----------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      2.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Block internal domain

.. rubric:: Configuration

=======================================  =======================================
Name                                     Description
Hostname_PaloAltoNGFW                    Hostname PaloAltoNGFW
User_PaloAltoNGFW                        User PaloAltoNGFW
Password_PaloAltoNGFW                    User PaloAltoNGFW
Security_rule_for_block_internal_domain  Name internal security rule for domains
TheHive_instance                         URL of the TheHive instance to query
TheHive_API_key                          TheHive API key with read access
=======================================  =======================================


PaloAltoNGFW_block_internal_user
--------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Block internal user

.. rubric:: Configuration

=====================================  =====================================
Name                                   Description
Hostname_PaloAltoNGFW                  Hostname PaloAltoNGFW
User_PaloAltoNGFW                      User PaloAltoNGFW
Password_PaloAltoNGFW                  User PaloAltoNGFW
Security_rule_for_block_internal_user  Name internal security rule for users
TheHive_instance                       URL of the TheHive instance to query
TheHive_API_key                        TheHive API key with read access
=====================================  =====================================


PaloAltoNGFW_block_port_for_external_communication
--------------------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      2.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Block external port communication

.. rubric:: Configuration

===================================================  ===================================================
Name                                                 Description
Hostname_PaloAltoNGFW                                Hostname PaloAltoNGFW
User_PaloAltoNGFW                                    User PaloAltoNGFW
Password_PaloAltoNGFW                                User PaloAltoNGFW
Security_rule_for_block_port_external_communication  Name external security rule for port communications
TheHive_instance                                     URL of the TheHive instance to query
TheHive_API_key                                      TheHive API key with read access
===================================================  ===================================================


PaloAltoNGFW_block_port_for_internal_communication
--------------------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      2.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Block internal port communication

.. rubric:: Configuration

===================================================  ===================================================
Name                                                 Description
Hostname_PaloAltoNGFW                                Hostname PaloAltoNGFW
User_PaloAltoNGFW                                    User PaloAltoNGFW
Password_PaloAltoNGFW                                User PaloAltoNGFW
Security_rule_for_block_port_internal_communication  Name internal security rule for port communications
TheHive_instance                                     URL of the TheHive instance to query
TheHive_API_key                                      TheHive API key with read access
===================================================  ===================================================


PaloAltoNGFW_unblock_external_IP_address
----------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Unblock external ip

.. rubric:: Configuration

=====================================  ==========================================
Name                                   Description
Hostname_PaloAltoNGFW                  Hostname PaloAltoNGFW
User_PaloAltoNGFW                      User PaloAltoNGFW
Password_PaloAltoNGFW                  User PaloAltoNGFW
Address_group_for_external_IP_address  Name external Address Group for IP address
TheHive_instance                       URL of the TheHive instance to query
TheHive_API_key                        TheHive API key with read access
=====================================  ==========================================


PaloAltoNGFW_unblock_external_domain
------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Unblock external domain

.. rubric:: Configuration

=========================================  =======================================
Name                                       Description
Hostname_PaloAltoNGFW                      Hostname PaloAltoNGFW
User_PaloAltoNGFW                          User PaloAltoNGFW
Password_PaloAltoNGFW                      User PaloAltoNGFW
Address_group_for_unblock_external_domain  Name external Address Group for domains
TheHive_instance                           URL of the TheHive instance to query
TheHive_API_key                            TheHive API key with read access
=========================================  =======================================


PaloAltoNGFW_unblock_external_user
----------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Unblock external user

.. rubric:: Configuration

=====================================  =====================================
Name                                   Description
Hostname_PaloAltoNGFW                  Hostname PaloAltoNGFW
User_PaloAltoNGFW                      User PaloAltoNGFW
Password_PaloAltoNGFW                  User PaloAltoNGFW
Security_rule_for_block_external_user  Name security rule for external users
TheHive_instance                       URL of the TheHive instance to query
TheHive_API_key                        TheHive API key with read access
=====================================  =====================================


PaloAltoNGFW_unblock_internal_IP_address
----------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Unblock internal ip

.. rubric:: Configuration

=====================================  ==========================================
Name                                   Description
Hostname_PaloAltoNGFW                  Hostname PaloAltoNGFW
User_PaloAltoNGFW                      User PaloAltoNGFW
Password_PaloAltoNGFW                  User PaloAltoNGFW
Address_group_for_internal_IP_address  Name internal Address Group for IP address
TheHive_instance                       URL of the TheHive instance to query
TheHive_API_key                        TheHive API key with read access
=====================================  ==========================================


PaloAltoNGFW_unblock_internal_domain
------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Unblock internal domain

.. rubric:: Configuration

=========================================  =======================================
Name                                       Description
Hostname_PaloAltoNGFW                      Hostname PaloAltoNGFW
User_PaloAltoNGFW                          User PaloAltoNGFW
Password_PaloAltoNGFW                      User PaloAltoNGFW
Address_group_for_unblock_internal_domain  Name internal Address Group for domains
TheHive_instance                           URL of the TheHive instance to query
TheHive_API_key                            TheHive API key with read access
=========================================  =======================================


PaloAltoNGFW_unblock_internal_user
----------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Unblock internal user

.. rubric:: Configuration

=====================================  =====================================
Name                                   Description
Hostname_PaloAltoNGFW                  Hostname PaloAltoNGFW
User_PaloAltoNGFW                      User PaloAltoNGFW
Password_PaloAltoNGFW                  User PaloAltoNGFW
Security_rule_for_block_internal_user  Name security rule for internal users
TheHive_instance                       URL of the TheHive instance to query
TheHive_API_key                        TheHive API key with read access
=====================================  =====================================


PaloAltoNGFW_unblock_port_for_external_communication
----------------------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Unblock external port communication

.. rubric:: Configuration

=============================================  ==================================================
Name                                           Description
Hostname_PaloAltoNGFW                          Hostname PaloAltoNGFW
User_PaloAltoNGFW                              User PaloAltoNGFW
Password_PaloAltoNGFW                          User PaloAltoNGFW
Service_group_for_external_port_communication  Name external Service Group for port communication
TheHive_instance                               URL of the TheHive instance to query
TheHive_API_key                                TheHive API key with read access
=============================================  ==================================================


PaloAltoNGFW_unblock_port_for_internal_communication
----------------------------------------------------

.. rubric:: Details

===========================  ==================================================
Author                       Maxim Konakin, OSCD Initiative
Version                      1.0.0
License                      AGPL-V3
Website                      https://www.paloaltonetworks.com/
Requires Registration        No
Requires Subscription        No
Free Subscription Available  No
DataType Supported           thehive:alert, thehive:case_artifact, thehive:case
===========================  ==================================================

.. rubric:: Description

Unblock internal port communication

.. rubric:: Configuration

=============================================  ==================================================
Name                                           Description
Hostname_PaloAltoNGFW                          Hostname PaloAltoNGFW
User_PaloAltoNGFW                              User PaloAltoNGFW
Password_PaloAltoNGFW                          User PaloAltoNGFW
Service_group_for_internal_port_communication  Name internal Service Group for port communication
TheHive_instance                               URL of the TheHive instance to query
TheHive_API_key                                TheHive API key with read access
=============================================  ==================================================


.. rubric:: Additional details from the README file:

.. role:: raw-html-m2r(raw)
   :format: html


Description of the responder module operation for the Palo Alto NGFW system
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This description contains the required actions from the engineer to integrate the responder with the Palo Alto NGFW.

Installation
~~~~~~~~~~~~

need install:


#. pip install cortexutils
#. pip install requests
#. pip install pan-os-python
#. pip install thehive4py

ToDo
^^^^

For responders to work, you need to upload the PaloAltoNGFW folder to the directory where other responders are stored.
Further it is necessary:


* 
  Reboot the cortex system;

* 
  To configure the responder, go to the cortex web console, go to the "Organization" tab, select the organization for which the configuration will be performed and go to the "Responders Config" tab and configure the fields for "PaloAltoNGFW_main" in accordance with their values:

  .. image:: assets/Responders.jpg
     :target: assets/Responders.jpg
     :alt: alt text



#. Hostname_PaloAltoNGFW - network address of the PaloAltoNGFW system
#. User_PaloAltoNGFW - user in the PaloAltoNGFW system
#. Password_PaloAltoNGFW - password for the user in the PaloAltoNGFW system
#. Security\ *rule*\ * - the name of the security rule in the PaloAltoNGFW system. The following standard rule names have been established:\ :raw-html-m2r:`<br>`
   4.1 To block/unblock user:\ :raw-html-m2r:`<br>`
   4.1.1 "TheHive Block internal user"\ :raw-html-m2r:`<br>`
   4.1.2 "TheHive Block external user"  

4.2 To block/unblock network addresses:
4.2.1 "TheHive Block internal IP address"\ :raw-html-m2r:`<br>`
4.2.2 "TheHive Block external IP address"  

4.3 To block/unblock FQDN:\ :raw-html-m2r:`<br>`
4.3.1 "TheHive Block external Domain"\ :raw-html-m2r:`<br>`
4.3.2 "TheHive Block internal Domain"  

4.4 To block/unblock ports: 
4.4.1 "TheHive Block port for internal communication"\ :raw-html-m2r:`<br>`
4.4.2 "TheHive Block port for external communication"  

4.5 TheHive_instance - url address of The Hive system (used only for case and alert types).
It is important for each organization to have its own user with the API!

4.6 TheHive_API_key - API key to connect to TheHive system\ :raw-html-m2r:`<br>`
Note: the specified safety rules must be created in PaloAltoNGFW, and also placed in the order of their application.\ :raw-html-m2r:`<br>`
Types of data used to work in TheHive system:


#. Network address - 'ip'
#. FQDN - 'hostname'
#. port-protocol - 'port-protocol'
#. Username - 'username'\ :raw-html-m2r:`<br>`
   Note: types 'port-protocol' and 'username' need to be created in TheHive system. By default, TheHive does not have these data types in the Observable type, so you must add it in the admin settings.\ :raw-html-m2r:`<br>`

   .. image:: assets/AddObservableType.jpg
      :target: assets/AddObservableType.jpg
      :alt: alt text

